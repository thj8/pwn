# 思路
- FILE的flag添加line属性，有\n的时候就会输出
- 把fileno3-->1,标准输出stdout
- %9$p等泄漏栈，程序，libc基地址
- 整体思路：1. 泄露地址 → 2. 计算栈布局 → 3. 覆盖read返回地址 → 4. 构造ROP链 → 5. 触发Shell。


# 知识点
## 3c84--> 3e84
增加了一个flag_IO_LINE_BUF (0x0200) : 启用行缓冲模式。在这种模式下，每次换行或缓冲区满时进行刷新。


![](https://r2.20161023.xyz/pic/20250513211532826.png)

![](https://r2.20161023.xyz/pic/20250513211630246.png)

![](https://r2.20161023.xyz/pic/20250513211706383.png)

## 112偏移量怎么算？
file_offset=0x56166dc55720-0x56166dc556b0=0x70=112

![](https://r2.20161023.xyz/pic/20250513211824430.png)


## 死循环，没有退出怎么getshell
